import{b4 as b,aw as n,h as g,ax as l}from"./R_UQo4UH.js";const q=()=>{const p=b().public.apiBase,s=n("products",()=>[]),u=n("categories",()=>[]),r=n("pagination",()=>null),i=n("products-loading",()=>!1),o=n("products-error",()=>null),d=n("cached-filters",()=>({})),m=a=>{const e={};return a.category&&a.category!=="all"&&(e.category=a.category),a.featured!==void 0&&(e.featured=a.featured?"1":"0"),a.in_stock!==void 0&&(e.in_stock=a.in_stock?"1":"0"),a.min_price&&(e.min_price=a.min_price.toString()),a.max_price&&(e.max_price=a.max_price.toString()),a.search&&(e.search=a.search),a.on_sale&&(e.on_sale="1"),a.page&&(e.page=a.page.toString()),e},c=async(a={})=>{i.value=!0,o.value=null;try{const e=m(a),t=await $fetch(`${p}products`,{query:e});return s.value=t.data||[],t.meta&&(r.value={total:t.meta.total,perPage:t.meta.per_page,currentPage:t.meta.current_page,lastPage:t.meta.last_page,from:t.meta.from,to:t.meta.to,hasMorePages:t.meta.current_page<t.meta.last_page}),d.value=a,{products:s.value,pagination:r.value}}catch(e){throw o.value=e.message||"Failed to fetch products",console.error("Error fetching products:",e),e}finally{i.value=!1}},v=async a=>{i.value=!0,o.value=null;try{return(await $fetch(`${p}products/${a}`)).data}catch(e){throw o.value=e.message||"Failed to fetch product",e}finally{i.value=!1}},h=async()=>{try{const a=await $fetch(`${p}content/navigation-items`);return u.value=a.data||[],u.value}catch(a){return console.error("Error fetching categories:",a),[]}},y=async(a,e={})=>{await c({...e,page:a})},f=async(a=8)=>await c({featured:!0,page:1}),P=async(a,e)=>await c({category:a}),_=async a=>await c({search:a}),w=async()=>{await c(d.value)},$=()=>{s.value=[],r.value=null,o.value=null,d.value={}},x=g(()=>u.value),C=g(()=>s.value.length>0),F=g(()=>r.value?.total||0),S=g(()=>r.value?.hasMorePages||!1);return u.value.length===0&&h(),{products:l(s),categories:l(u),pagination:l(r),loading:l(i),error:l(o),fetchProducts:c,fetchProduct:v,fetchCategories:h,changePage:y,getFeaturedProducts:f,getProductsByCategory:P,searchProducts:_,refresh:w,clear:$,getAllCategories:x,hasProducts:C,totalProducts:F,hasMorePages:S}};export{q as u};
